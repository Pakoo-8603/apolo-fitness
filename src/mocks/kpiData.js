/**
 * Dataset semilla para los módulos de KPIs.
 *
 * Las estructuras siguen los modelos Django descritos en `todos_modelos.py`.
 * Los datos se mantienen en memoria, pero este archivo también se emplea para
 * rehidratar `localStorage` cuando el usuario desea persistir cambios desde el
 * frontend.
 */

export const KPI_STORAGE_KEY = 'apolo-fitness:kpis:v1'

const seedTimestamp = new Date('2025-02-20T10:00:00Z')

const ventasRecords = [
  { id: 1, fecha: '2024-01-08', total: 11250, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
  { id: 2, fecha: '2024-01-22', total: 9850, sucursal: 'Norte', metodo_pago: 'efectivo', cliente_tipo: 'recurrente', procesado: true },
  { id: 3, fecha: '2024-02-05', total: 11800, sucursal: 'Matriz', metodo_pago: 'transferencia', cliente_tipo: 'nuevo', procesado: true },
  { id: 4, fecha: '2024-02-18', total: 12560, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'recurrente', procesado: true },
  { id: 5, fecha: '2024-12-04', total: 18750, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
  { id: 6, fecha: '2024-12-12', total: 17980, sucursal: 'Norte', metodo_pago: 'transferencia', cliente_tipo: 'recurrente', procesado: true },
  { id: 7, fecha: '2024-12-22', total: 16210, sucursal: 'Matriz', metodo_pago: 'efectivo', cliente_tipo: 'recurrente', procesado: true },
  { id: 8, fecha: '2025-01-03', total: 20540, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
  { id: 9, fecha: '2025-01-07', total: 18860, sucursal: 'Norte', metodo_pago: 'tarjeta', cliente_tipo: 'recurrente', procesado: true },
  { id: 10, fecha: '2025-01-15', total: 21430, sucursal: 'Matriz', metodo_pago: 'transferencia', cliente_tipo: 'nuevo', procesado: true },
  { id: 11, fecha: '2025-01-21', total: 19840, sucursal: 'Matriz', metodo_pago: 'efectivo', cliente_tipo: 'recurrente', procesado: true },
  { id: 12, fecha: '2025-01-29', total: 22310, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
  { id: 13, fecha: '2025-02-02', total: 22110, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
  { id: 14, fecha: '2025-02-06', total: 21380, sucursal: 'Norte', metodo_pago: 'transferencia', cliente_tipo: 'recurrente', procesado: true },
  { id: 15, fecha: '2025-02-12', total: 22890, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
  { id: 16, fecha: '2025-02-15', total: 21970, sucursal: 'Matriz', metodo_pago: 'efectivo', cliente_tipo: 'recurrente', procesado: true },
  { id: 17, fecha: '2025-02-19', total: 24150, sucursal: 'Matriz', metodo_pago: 'tarjeta', cliente_tipo: 'nuevo', procesado: true },
]

const egresosRecords = [
  { id: 1, fecha: '2024-12-05', monto: 8200, sucursal: 'Matriz', categoria: 'Servicios', forma_pago: 'transferencia' },
  { id: 2, fecha: '2024-12-18', monto: 7650, sucursal: 'Norte', categoria: 'Nómina', forma_pago: 'transferencia' },
  { id: 3, fecha: '2025-01-09', monto: 9450, sucursal: 'Matriz', categoria: 'Renta', forma_pago: 'transferencia' },
  { id: 4, fecha: '2025-01-16', monto: 8120, sucursal: 'Matriz', categoria: 'Servicios', forma_pago: 'tarjeta' },
  { id: 5, fecha: '2025-01-23', monto: 7560, sucursal: 'Norte', categoria: 'Mantenimiento', forma_pago: 'efectivo' },
  { id: 6, fecha: '2025-02-04', monto: 9880, sucursal: 'Matriz', categoria: 'Renta', forma_pago: 'transferencia' },
  { id: 7, fecha: '2025-02-11', monto: 8340, sucursal: 'Matriz', categoria: 'Servicios', forma_pago: 'transferencia' },
  { id: 8, fecha: '2025-02-18', monto: 7690, sucursal: 'Norte', categoria: 'Nómina', forma_pago: 'transferencia' },
]

const accesosRecords = [
  { id: 1, fecha: '2025-02-20T05:45:00', sucursal: 'Matriz', tipo_acceso: 'entrada', puerta: 'personal' },
  { id: 2, fecha: '2025-02-20T06:05:00', sucursal: 'Matriz', tipo_acceso: 'entrada', puerta: 'personal' },
  { id: 3, fecha: '2025-02-20T13:05:00', sucursal: 'Matriz', tipo_acceso: 'salida', puerta: 'personal' },
  { id: 4, fecha: '2025-02-20T14:10:00', sucursal: 'Matriz', tipo_acceso: 'salida', puerta: 'personal' },
  { id: 5, fecha: '2025-02-20T06:30:00', sucursal: 'Matriz', tipo_acceso: 'entrada', puerta: 'principal' },
  { id: 6, fecha: '2025-02-20T06:34:00', sucursal: 'Matriz', tipo_acceso: 'entrada', puerta: 'principal' },
  { id: 7, fecha: '2025-02-20T18:40:00', sucursal: 'Matriz', tipo_acceso: 'salida', puerta: 'principal' },
  { id: 8, fecha: '2025-02-20T19:05:00', sucursal: 'Matriz', tipo_acceso: 'salida', puerta: 'principal' },
  { id: 9, fecha: '2025-02-19T06:10:00', sucursal: 'Norte', tipo_acceso: 'entrada', puerta: 'personal' },
  { id: 10, fecha: '2025-02-19T12:30:00', sucursal: 'Norte', tipo_acceso: 'salida', puerta: 'personal' },
  { id: 11, fecha: '2025-02-19T07:12:00', sucursal: 'Norte', tipo_acceso: 'entrada', puerta: 'principal' },
  { id: 12, fecha: '2025-02-19T19:12:00', sucursal: 'Norte', tipo_acceso: 'salida', puerta: 'principal' },
]

const altasPlanRecords = [
  {
    id: 1,
    empresa_id: 1,
    fecha_alta: '2024-12-12',
    sucursal: 'Matriz',
    plan: { id: 101, nombre: 'Plan Premium' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-01-11',
    fecha_baja: null,
  },
  {
    id: 2,
    empresa_id: 1,
    fecha_alta: '2024-12-18',
    sucursal: 'Matriz',
    plan: { id: 102, nombre: 'Plan Ilimitado' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-01-17',
    fecha_baja: null,
  },
  {
    id: 3,
    empresa_id: 1,
    fecha_alta: '2025-01-04',
    sucursal: 'Matriz',
    plan: { id: 101, nombre: 'Plan Premium' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-02-03',
    fecha_baja: null,
  },
  {
    id: 4,
    empresa_id: 1,
    fecha_alta: '2025-01-08',
    sucursal: 'Norte',
    plan: { id: 103, nombre: 'Plan Express' },
    estado: 'activo',
    pago_al_dia: false,
    fecha_vencimiento: '2025-02-07',
    fecha_baja: null,
  },
  {
    id: 5,
    empresa_id: 1,
    fecha_alta: '2025-01-12',
    sucursal: 'Matriz',
    plan: { id: 104, nombre: 'Plan Yoga' },
    estado: 'suspendido',
    pago_al_dia: false,
    fecha_vencimiento: '2025-02-11',
    fecha_baja: '2025-02-05',
  },
  {
    id: 6,
    empresa_id: 1,
    fecha_alta: '2025-01-18',
    sucursal: 'Matriz',
    plan: { id: 101, nombre: 'Plan Premium' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-02-17',
    fecha_baja: null,
  },
  {
    id: 7,
    empresa_id: 1,
    fecha_alta: '2025-01-27',
    sucursal: 'Norte',
    plan: { id: 102, nombre: 'Plan Ilimitado' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-02-26',
    fecha_baja: null,
  },
  {
    id: 8,
    empresa_id: 1,
    fecha_alta: '2025-02-02',
    sucursal: 'Matriz',
    plan: { id: 101, nombre: 'Plan Premium' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-03-03',
    fecha_baja: null,
  },
  {
    id: 9,
    empresa_id: 1,
    fecha_alta: '2025-02-05',
    sucursal: 'Matriz',
    plan: { id: 103, nombre: 'Plan Express' },
    estado: 'cancelado',
    pago_al_dia: false,
    fecha_vencimiento: '2025-03-06',
    fecha_baja: '2025-02-18',
  },
  {
    id: 10,
    empresa_id: 1,
    fecha_alta: '2025-02-11',
    sucursal: 'Matriz',
    plan: { id: 104, nombre: 'Plan Yoga' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2025-03-12',
    fecha_baja: null,
  },
  {
    id: 11,
    empresa_id: 1,
    fecha_alta: '2024-01-10',
    sucursal: 'Matriz',
    plan: { id: 101, nombre: 'Plan Premium' },
    estado: 'cancelado',
    pago_al_dia: false,
    fecha_vencimiento: '2024-02-09',
    fecha_baja: '2024-02-12',
  },
  {
    id: 12,
    empresa_id: 1,
    fecha_alta: '2024-02-03',
    sucursal: 'Norte',
    plan: { id: 104, nombre: 'Plan Yoga' },
    estado: 'cancelado',
    pago_al_dia: false,
    fecha_vencimiento: '2024-03-04',
    fecha_baja: '2024-02-28',
  },
  {
    id: 13,
    empresa_id: 1,
    fecha_alta: '2024-02-14',
    sucursal: 'Matriz',
    plan: { id: 102, nombre: 'Plan Ilimitado' },
    estado: 'activo',
    pago_al_dia: true,
    fecha_vencimiento: '2024-03-15',
    fecha_baja: null,
  },
  {
    id: 14,
    empresa_id: 1,
    fecha_alta: '2024-12-02',
    sucursal: 'Matriz',
    plan: { id: 103, nombre: 'Plan Express' },
    estado: 'cancelado',
    pago_al_dia: false,
    fecha_vencimiento: '2025-01-01',
    fecha_baja: '2025-01-20',
  },
]

const financialFlowRecords = [
  ...ventasRecords.map(venta => ({
    id: `ing-${venta.id}`,
    fecha: venta.fecha,
    tipo: 'ingreso',
    monto: venta.total,
    sucursal: venta.sucursal,
  })),
  ...egresosRecords.map(egreso => ({
    id: `egr-${egreso.id}`,
    fecha: egreso.fecha,
    tipo: 'gasto',
    monto: egreso.monto,
    sucursal: egreso.sucursal,
  })),
]

export function buildSeedData () {
  return {
    generated_at: seedTimestamp.toISOString(),
    sources: [
      {
        id: 1,
        empresa_id: 1,
        code: 'ventas',
        name: 'Ventas',
        description: 'Ventas registradas por empresa y sucursal.',
        content_type: 'ventas.Venta',
        default_date_field_name: 'fecha',
        base_filters: { procesado: true },
        metadata: { currency: 'MXN', sample_records: 'ventas' },
        is_template: false,
      },
      {
        id: 2,
        empresa_id: 1,
        code: 'egresos',
        name: 'Egresos',
        description: 'Egresos registrados en finanzas.',
        content_type: 'finanzas.Egreso',
        default_date_field_name: 'fecha',
        base_filters: {},
        metadata: { currency: 'MXN', sample_records: 'egresos' },
        is_template: false,
      },
      {
        id: 3,
        empresa_id: 1,
        code: 'accesos',
        name: 'Accesos',
        description: 'Entradas y salidas registradas en torniquetes.',
        content_type: 'planes.Acceso',
        default_date_field_name: 'fecha',
        base_filters: {},
        metadata: { sample_records: 'accesos' },
        is_template: false,
      },
      {
        id: 4,
        empresa_id: 1,
        code: 'altas_plan',
        name: 'Altas de plan',
        description: 'Altas, bajas y estado de membresías.',
        content_type: 'planes.AltaPlan',
        default_date_field_name: 'fecha_alta',
        base_filters: {},
        metadata: { sample_records: 'altas' },
        is_template: false,
      },
      {
        id: 5,
        empresa_id: 1,
        code: 'flujo_financiero',
        name: 'Flujo financiero',
        description: 'Vista consolidada de ingresos y gastos.',
        content_type: 'finanzas.FlujoCaja',
        default_date_field_name: 'fecha',
        base_filters: {},
        metadata: { derived_from: ['ventas', 'egresos'], sample_records: 'flujo' },
        is_template: false,
      },
    ],
    sourceFields: [
      { id: 1, source_id: 1, name: 'total', label: 'Total de la venta', field_type: 'numeric', allowed_aggregations: ['sum', 'avg', 'max', 'min'], metadata: { currency: 'MXN' }, order: 1, is_default: true },
      { id: 2, source_id: 1, name: 'fecha', label: 'Fecha de venta', field_type: 'date', allowed_aggregations: [], metadata: {}, order: 2, is_default: true },
      { id: 3, source_id: 1, name: 'sucursal', label: 'Sucursal', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 3, is_default: true },
      { id: 4, source_id: 1, name: 'metodo_pago', label: 'Método de pago', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 4, is_default: false },
      { id: 5, source_id: 2, name: 'monto', label: 'Monto del egreso', field_type: 'numeric', allowed_aggregations: ['sum', 'avg', 'max', 'min'], metadata: { currency: 'MXN' }, order: 1, is_default: true },
      { id: 6, source_id: 2, name: 'fecha', label: 'Fecha del egreso', field_type: 'date', allowed_aggregations: [], metadata: {}, order: 2, is_default: true },
      { id: 7, source_id: 2, name: 'sucursal', label: 'Sucursal', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 3, is_default: false },
      { id: 8, source_id: 2, name: 'categoria', label: 'Categoría', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 4, is_default: false },
      { id: 9, source_id: 3, name: 'fecha', label: 'Fecha de acceso', field_type: 'date', allowed_aggregations: [], metadata: {}, order: 1, is_default: true },
      { id: 10, source_id: 3, name: 'sucursal', label: 'Sucursal', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 2, is_default: true },
      { id: 11, source_id: 3, name: 'tipo_acceso', label: 'Tipo de acceso', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 3, is_default: true },
      { id: 12, source_id: 3, name: 'puerta', label: 'Puerta', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 4, is_default: false },
      { id: 13, source_id: 4, name: 'fecha_alta', label: 'Fecha de alta', field_type: 'date', allowed_aggregations: [], metadata: {}, order: 1, is_default: true },
      { id: 14, source_id: 4, name: 'plan__nombre', label: 'Plan', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 2, is_default: true },
      { id: 15, source_id: 4, name: 'estado', label: 'Estado de membresía', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 3, is_default: true },
      { id: 16, source_id: 4, name: 'pago_al_dia', label: 'Pago al día', field_type: 'boolean', allowed_aggregations: [], metadata: {}, order: 4, is_default: false },
      { id: 17, source_id: 4, name: 'fecha_baja', label: 'Fecha de baja', field_type: 'date', allowed_aggregations: [], metadata: {}, order: 5, is_default: false },
      { id: 18, source_id: 4, name: 'sucursal', label: 'Sucursal', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 6, is_default: false },
      { id: 20, source_id: 5, name: 'monto', label: 'Monto', field_type: 'numeric', allowed_aggregations: ['sum', 'avg', 'max', 'min'], metadata: { currency: 'MXN' }, order: 1, is_default: true },
      { id: 21, source_id: 5, name: 'fecha', label: 'Fecha', field_type: 'date', allowed_aggregations: [], metadata: {}, order: 2, is_default: true },
      { id: 22, source_id: 5, name: 'tipo', label: 'Tipo', field_type: 'dimension', allowed_aggregations: [], metadata: {}, order: 3, is_default: true },
    ],
    metrics: [
      { id: 1, empresa_id: 1, code: 'ingresos_mes_actual', name: 'Ingresos del mes', description: 'Suma de ingresos del mes en curso.', source_id: 1, aggregation: 'sum', value_field_id: 1, date_field_id: 2, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: true, extra_config: { currency: 'MXN' }, order: 1, is_template: false },
      { id: 2, empresa_id: 1, code: 'gastos_mes_actual', name: 'Gastos del mes', description: 'Suma de egresos del mes en curso.', source_id: 2, aggregation: 'sum', value_field_id: 5, date_field_id: 6, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: true, extra_config: { currency: 'MXN' }, order: 2, is_template: false },
      { id: 3, empresa_id: 1, code: 'flujo_financiero_mes', name: 'Ingresos vs gastos', description: 'Comparativo de ingresos y gastos del mes.', source_id: 5, aggregation: 'sum', value_field_id: 20, date_field_id: 21, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: { currency: 'MXN' }, order: 3, is_template: false },
      { id: 4, empresa_id: 1, code: 'ingresos_enero_2025', name: 'Ingresos enero 2025', description: 'Ingresos registrados durante enero de 2025.', source_id: 1, aggregation: 'sum', value_field_id: 1, date_field_id: 2, time_window: 'custom', custom_start: '2025-01-01', custom_end: '2025-01-31', compare_against_previous: false, extra_config: { currency: 'MXN' }, order: 4, is_template: false },
      { id: 5, empresa_id: 1, code: 'ingresos_diciembre_2024', name: 'Ingresos diciembre 2024', description: 'Ingresos registrados durante diciembre de 2024.', source_id: 1, aggregation: 'sum', value_field_id: 1, date_field_id: 2, time_window: 'custom', custom_start: '2024-12-01', custom_end: '2024-12-31', compare_against_previous: false, extra_config: { currency: 'MXN' }, order: 5, is_template: false },
      { id: 6, empresa_id: 1, code: 'ingresos_ene_feb_2025', name: 'Ingresos ene-feb 2025', description: 'Ingresos acumulados enero-febrero 2025.', source_id: 1, aggregation: 'sum', value_field_id: 1, date_field_id: 2, time_window: 'custom', custom_start: '2025-01-01', custom_end: '2025-02-28', compare_against_previous: false, extra_config: { currency: 'MXN' }, order: 6, is_template: false },
      { id: 7, empresa_id: 1, code: 'ingresos_ene_feb_2024', name: 'Ingresos ene-feb 2024', description: 'Ingresos acumulados enero-febrero 2024.', source_id: 1, aggregation: 'sum', value_field_id: 1, date_field_id: 2, time_window: 'custom', custom_start: '2024-01-01', custom_end: '2024-02-29', compare_against_previous: false, extra_config: { currency: 'MXN' }, order: 7, is_template: false },
      { id: 8, empresa_id: 1, code: 'membresias_estado_actual', name: 'Estado de membresías', description: 'Conteo de membresías por estado en el mes.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 8, is_template: false },
      { id: 9, empresa_id: 1, code: 'membresias_activas', name: 'Membresías activas', description: 'Conteo de membresías activas en el mes.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 9, is_template: false },
      { id: 10, empresa_id: 1, code: 'membresias_pago_dia', name: 'Membresías con pago al día', description: 'Membresías activas con pagos vigentes.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 10, is_template: false },
      { id: 11, empresa_id: 1, code: 'personal_entradas_hoy', name: 'Entradas de personal (hoy)', description: 'Entradas de personal registradas el día de hoy.', source_id: 3, aggregation: 'count', value_field_id: null, date_field_id: 9, time_window: 'today', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 11, is_template: false },
      { id: 12, empresa_id: 1, code: 'personal_salidas_hoy', name: 'Salidas de personal (hoy)', description: 'Salidas de personal registradas el día de hoy.', source_id: 3, aggregation: 'count', value_field_id: null, date_field_id: 9, time_window: 'today', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 12, is_template: false },
      { id: 13, empresa_id: 1, code: 'personal_por_hora', name: 'Entradas de personal por hora', description: 'Distribución de entradas de personal por hora.', source_id: 3, aggregation: 'count', value_field_id: null, date_field_id: 9, time_window: 'today', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 13, is_template: false },
      { id: 14, empresa_id: 1, code: 'planes_activos_por_plan', name: 'Activos por plan', description: 'Conteo de miembros activos por plan.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 14, is_template: false },
      { id: 15, empresa_id: 1, code: 'bajas_por_mes', name: 'Bajas por mes', description: 'Bajas registradas durante el año por mes.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 17, time_window: 'this_year', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 15, is_template: false },
      { id: 16, empresa_id: 1, code: 'bajas_mes_actual', name: 'Bajas del mes', description: 'Bajas registradas en el mes en curso.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 17, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 16, is_template: false },
      { id: 17, empresa_id: 1, code: 'bajas_mes_anterior', name: 'Bajas mes anterior', description: 'Bajas registradas en el mes anterior.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 17, time_window: 'custom', custom_start: '2025-01-01', custom_end: '2025-01-31', compare_against_previous: false, extra_config: {}, order: 17, is_template: false },
      { id: 18, empresa_id: 1, code: 'bajas_ene_feb_2025', name: 'Bajas ene-feb 2025', description: 'Bajas registradas enero-febrero 2025.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 17, time_window: 'custom', custom_start: '2025-01-01', custom_end: '2025-02-28', compare_against_previous: false, extra_config: {}, order: 18, is_template: false },
      { id: 19, empresa_id: 1, code: 'bajas_ene_feb_2024', name: 'Bajas ene-feb 2024', description: 'Bajas registradas enero-febrero 2024.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 17, time_window: 'custom', custom_start: '2024-01-01', custom_end: '2024-02-29', compare_against_previous: false, extra_config: {}, order: 19, is_template: false },
      { id: 20, empresa_id: 1, code: 'altas_mes_actual', name: 'Altas del mes', description: 'Altas registradas en el mes en curso.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'this_month', custom_start: null, custom_end: null, compare_against_previous: false, extra_config: {}, order: 20, is_template: false },
      { id: 21, empresa_id: 1, code: 'altas_mes_anterior', name: 'Altas mes anterior', description: 'Altas registradas en el mes anterior.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'custom', custom_start: '2025-01-01', custom_end: '2025-01-31', compare_against_previous: false, extra_config: {}, order: 21, is_template: false },
      { id: 22, empresa_id: 1, code: 'altas_ene_feb_2025', name: 'Altas ene-feb 2025', description: 'Altas registradas enero-febrero 2025.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'custom', custom_start: '2025-01-01', custom_end: '2025-02-28', compare_against_previous: false, extra_config: {}, order: 22, is_template: false },
      { id: 23, empresa_id: 1, code: 'altas_ene_feb_2024', name: 'Altas ene-feb 2024', description: 'Altas registradas enero-febrero 2024.', source_id: 4, aggregation: 'count', value_field_id: null, date_field_id: 13, time_window: 'custom', custom_start: '2024-01-01', custom_end: '2024-02-29', compare_against_previous: false, extra_config: {}, order: 23, is_template: false },
    ],
    metricFilters: [
      { id: 1, metric_id: 9, field_id: 15, operator: 'eq', value: 'activo', connector: 'and', order: 1 },
      { id: 2, metric_id: 10, field_id: 15, operator: 'eq', value: 'activo', connector: 'and', order: 1 },
      { id: 3, metric_id: 10, field_id: 16, operator: 'eq', value: true, connector: 'and', order: 2 },
      { id: 4, metric_id: 11, field_id: 12, operator: 'eq', value: 'personal', connector: 'and', order: 1 },
      { id: 5, metric_id: 11, field_id: 11, operator: 'eq', value: 'entrada', connector: 'and', order: 2 },
      { id: 6, metric_id: 12, field_id: 12, operator: 'eq', value: 'personal', connector: 'and', order: 1 },
      { id: 7, metric_id: 12, field_id: 11, operator: 'eq', value: 'salida', connector: 'and', order: 2 },
      { id: 8, metric_id: 13, field_id: 12, operator: 'eq', value: 'personal', connector: 'and', order: 1 },
      { id: 9, metric_id: 13, field_id: 11, operator: 'eq', value: 'entrada', connector: 'and', order: 2 },
      { id: 10, metric_id: 14, field_id: 15, operator: 'eq', value: 'activo', connector: 'and', order: 1 },
      { id: 11, metric_id: 15, field_id: 15, operator: 'eq', value: 'cancelado', connector: 'and', order: 1 },
      { id: 12, metric_id: 16, field_id: 15, operator: 'eq', value: 'cancelado', connector: 'and', order: 1 },
      { id: 13, metric_id: 17, field_id: 15, operator: 'eq', value: 'cancelado', connector: 'and', order: 1 },
      { id: 14, metric_id: 18, field_id: 15, operator: 'eq', value: 'cancelado', connector: 'and', order: 1 },
      { id: 15, metric_id: 19, field_id: 15, operator: 'eq', value: 'cancelado', connector: 'and', order: 1 },
    ],
    metricDimensions: [
      { id: 1, metric_id: 3, field_id: 22, granularity: 'exact', limit: null, order: 1 },
      { id: 2, metric_id: 8, field_id: 15, granularity: 'exact', limit: null, order: 1 },
      { id: 3, metric_id: 13, field_id: 9, granularity: 'hour', limit: null, order: 1 },
      { id: 4, metric_id: 14, field_id: 14, granularity: 'exact', limit: null, order: 1 },
      { id: 5, metric_id: 15, field_id: 17, granularity: 'month', limit: null, order: 1 },
    ],
    definitions: [
      { id: 1, empresa_id: 1, code: 'kpi_ingresos_vs_gastos', name: 'Ingresos vs gastos', description: 'Comparativo de ingresos y gastos del mes en curso.', calculation_type: 'metric', metric_id: 3, expression: '', format_type: 'currency', baseline_metric_id: null, extra_config: { currency: 'MXN' }, is_template: false },
      { id: 2, empresa_id: 1, code: 'kpi_variacion_ingresos_mes', name: 'Variación de ingresos (mes)', description: 'Relación entre los ingresos de enero 2025 vs diciembre 2024.', calculation_type: 'formula', metric_id: null, expression: "diciembre_previo ? (enero_actual / Math.max(diciembre_previo, 1)) - 1 : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
      { id: 3, empresa_id: 1, code: 'kpi_variacion_ingresos_yoy', name: 'Variación de ingresos (YoY)', description: 'Relación entre ene-feb 2025 vs ene-feb 2024.', calculation_type: 'formula', metric_id: null, expression: "ene_feb_2024 ? (ene_feb_2025 / Math.max(ene_feb_2024, 1)) - 1 : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
      { id: 4, empresa_id: 1, code: 'kpi_membresias_estado', name: 'Activos, cancelados y suspendidos', description: 'Distribución de membresías por estado.', calculation_type: 'metric', metric_id: 8, expression: '', format_type: 'value', baseline_metric_id: null, extra_config: {}, is_template: false },
      { id: 5, empresa_id: 1, code: 'kpi_activos_pago_dia', name: 'Activos con pago al día', description: 'Relación de membresías activas con pagos al corriente.', calculation_type: 'formula', metric_id: null, expression: "activos ? (pagados / Math.max(activos, 1)) : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
      { id: 6, empresa_id: 1, code: 'kpi_personal_en_gimnasio', name: 'Personal en el gimnasio', description: 'Diferencia entre entradas y salidas de personal hoy.', calculation_type: 'formula', metric_id: null, expression: 'entradas - salidas', format_type: 'value', baseline_metric_id: null, extra_config: { decimals: 0 }, is_template: false },
      { id: 7, empresa_id: 1, code: 'kpi_personal_por_hora', name: 'Personal en el gimnasio por hora', description: 'Entradas de personal agrupadas por hora.', calculation_type: 'metric', metric_id: 13, expression: '', format_type: 'value', baseline_metric_id: null, extra_config: {}, is_template: false },
      { id: 8, empresa_id: 1, code: 'kpi_plan_mas_personas', name: 'Plan con más personas', description: 'Planes con mayor cantidad de miembros activos.', calculation_type: 'metric', metric_id: 14, expression: '', format_type: 'value', baseline_metric_id: null, extra_config: {}, is_template: false },
      { id: 9, empresa_id: 1, code: 'kpi_plan_menos_personas', name: 'Plan con menos personas', description: 'Planes con menor cantidad de miembros activos.', calculation_type: 'metric', metric_id: 14, expression: '', format_type: 'value', baseline_metric_id: null, extra_config: {}, is_template: false },
      { id: 10, empresa_id: 1, code: 'kpi_crecimiento_inscripciones_mes', name: 'Crecimiento de inscripciones (mes)', description: 'Comparativo de altas del mes vs mes anterior.', calculation_type: 'formula', metric_id: null, expression: "altas_mes_anterior ? (altas_mes / Math.max(altas_mes_anterior, 1)) - 1 : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
      { id: 11, empresa_id: 1, code: 'kpi_crecimiento_inscripciones_yoy', name: 'Crecimiento de inscripciones (YoY)', description: 'Comparativo de altas ene-feb 2025 vs ene-feb 2024.', calculation_type: 'formula', metric_id: null, expression: "altas_ene_feb_2024 ? (altas_ene_feb_2025 / Math.max(altas_ene_feb_2024, 1)) - 1 : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
      { id: 12, empresa_id: 1, code: 'kpi_bajas_por_mes', name: 'Bajas por mes', description: 'Bajas de membresías por mes en el año.', calculation_type: 'metric', metric_id: 15, expression: '', format_type: 'value', baseline_metric_id: null, extra_config: {}, is_template: false },
      { id: 13, empresa_id: 1, code: 'kpi_bajas_mes_vs_anterior', name: 'Bajas mes vs anterior', description: 'Relación entre bajas del mes y el mes anterior.', calculation_type: 'formula', metric_id: null, expression: "bajas_mes_anterior ? (bajas_mes_actual / Math.max(bajas_mes_anterior, 1)) - 1 : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
      { id: 14, empresa_id: 1, code: 'kpi_bajas_yoy', name: 'Bajas ene-feb YoY', description: 'Relación entre bajas ene-feb 2025 vs ene-feb 2024.', calculation_type: 'formula', metric_id: null, expression: "bajas_ene_feb_2024 ? (bajas_ene_feb_2025 / Math.max(bajas_ene_feb_2024, 1)) - 1 : 0", format_type: 'percentage', baseline_metric_id: null, extra_config: { decimals: 2 }, is_template: false },
    ],
    definitionMetrics: [
      { id: 1, definition_id: 2, metric_id: 4, alias: 'enero_actual', order: 1 },
      { id: 2, definition_id: 2, metric_id: 5, alias: 'diciembre_previo', order: 2 },
      { id: 3, definition_id: 2, metric_id: 6, alias: 'ene_feb_2025', order: 3 },
      { id: 4, definition_id: 2, metric_id: 7, alias: 'ene_feb_2024', order: 4 },
      { id: 5, definition_id: 3, metric_id: 6, alias: 'ene_feb_2025', order: 1 },
      { id: 6, definition_id: 3, metric_id: 7, alias: 'ene_feb_2024', order: 2 },
      { id: 7, definition_id: 5, metric_id: 9, alias: 'activos', order: 1 },
      { id: 8, definition_id: 5, metric_id: 10, alias: 'pagados', order: 2 },
      { id: 9, definition_id: 6, metric_id: 11, alias: 'entradas', order: 1 },
      { id: 10, definition_id: 6, metric_id: 12, alias: 'salidas', order: 2 },
      { id: 11, definition_id: 10, metric_id: 20, alias: 'altas_mes', order: 1 },
      { id: 12, definition_id: 10, metric_id: 21, alias: 'altas_mes_anterior', order: 2 },
      { id: 13, definition_id: 10, metric_id: 22, alias: 'altas_ene_feb_2025', order: 3 },
      { id: 14, definition_id: 10, metric_id: 23, alias: 'altas_ene_feb_2024', order: 4 },
      { id: 15, definition_id: 11, metric_id: 22, alias: 'altas_ene_feb_2025', order: 1 },
      { id: 16, definition_id: 11, metric_id: 23, alias: 'altas_ene_feb_2024', order: 2 },
      { id: 17, definition_id: 13, metric_id: 16, alias: 'bajas_mes_actual', order: 1 },
      { id: 18, definition_id: 13, metric_id: 17, alias: 'bajas_mes_anterior', order: 2 },
      { id: 19, definition_id: 14, metric_id: 18, alias: 'bajas_ene_feb_2025', order: 1 },
      { id: 20, definition_id: 14, metric_id: 19, alias: 'bajas_ene_feb_2024', order: 2 },
    ],
    dashboards: [
      { id: 1, empresa_id: 1, owner_id: 1, name: 'Dirección General', slug: 'principal', description: 'KPIs clave financieros y operativos.', is_default: true, layout: { columns: 12, rowHeight: 120 } },
      { id: 2, empresa_id: null, owner_id: null, name: 'Plantilla KPIs', slug: 'plantilla-kpis', description: 'Plantilla base para nuevas empresas.', is_default: false, layout: { columns: 12, rowHeight: 120 } },
    ],
    widgets: [
      { id: 1, dashboard_id: 1, definition_id: 1, title: 'Ingresos vs gastos', subtitle: 'Mes en curso', order: 1, size: { w: 6, h: 3 }, position: { x: 0, y: 0 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'bar', palette: 'emerald' } },
      { id: 2, dashboard_id: 1, definition_id: 2, title: 'Variación ingresos mensual', subtitle: 'Enero 2025 vs diciembre 2024', order: 2, size: { w: 3, h: 3 }, position: { x: 6, y: 0 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'emerald', showComponents: true, componentFormat: 'currency', componentLabels: { enero_actual: 'Ingresos enero 2025', diciembre_previo: 'Ingresos diciembre 2024', ene_feb_2025: 'Ingresos ene-feb 2025', ene_feb_2024: 'Ingresos ene-feb 2024' }, derivedRows: [{ label: 'Variación ene-feb YoY', expression: "ene_feb_2024 ? (ene_feb_2025 / Math.max(ene_feb_2024, 1)) - 1 : 0", format: 'percentage', decimals: 2 }] } },
      { id: 3, dashboard_id: 1, definition_id: 3, title: 'Variación ingresos YoY', subtitle: 'Ene-feb 2025 vs 2024', order: 3, size: { w: 3, h: 3 }, position: { x: 9, y: 0 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'emerald', showComponents: true, componentFormat: 'currency', componentLabels: { ene_feb_2025: 'Ingresos ene-feb 2025', ene_feb_2024: 'Ingresos ene-feb 2024' } } },
      { id: 4, dashboard_id: 1, definition_id: 4, title: 'Estado de membresías', subtitle: 'Mes en curso', order: 4, size: { w: 4, h: 3 }, position: { x: 0, y: 3 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'bar', palette: 'sky' } },
      { id: 5, dashboard_id: 1, definition_id: 5, title: 'Pagos al día', subtitle: 'Activos con pago vs total activos', order: 5, size: { w: 2, h: 3 }, position: { x: 4, y: 3 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'emerald', showComponents: true, componentLabels: { activos: 'Membresías activas', pagados: 'Pagos al día' } } },
      { id: 6, dashboard_id: 1, definition_id: 6, title: 'Personal presente', subtitle: 'Día en curso', order: 6, size: { w: 2, h: 3 }, position: { x: 6, y: 3 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'amber', showComponents: true, componentLabels: { entradas: 'Entradas hoy', salidas: 'Salidas hoy' } } },
      { id: 7, dashboard_id: 1, definition_id: 7, title: 'Personal por hora', subtitle: 'Entradas de personal hoy', order: 7, size: { w: 4, h: 3 }, position: { x: 8, y: 3 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'bar', palette: 'teal' } },
      { id: 8, dashboard_id: 1, definition_id: 8, title: 'Plan más popular', subtitle: 'Activos del mes', order: 8, size: { w: 3, h: 3 }, position: { x: 0, y: 6 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'table', limitRows: 1 } },
      { id: 9, dashboard_id: 1, definition_id: 9, title: 'Plan menos personas', subtitle: 'Activos del mes', order: 9, size: { w: 3, h: 3 }, position: { x: 3, y: 6 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'table', sortDirection: 'asc', limitRows: 1 } },
      { id: 10, dashboard_id: 1, definition_id: 10, title: 'Crecimiento inscripciones', subtitle: 'Mes vs mes anterior', order: 10, size: { w: 3, h: 3 }, position: { x: 6, y: 6 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'emerald', showComponents: true, componentLabels: { altas_mes: 'Altas mes actual', altas_mes_anterior: 'Altas mes anterior' }, derivedRows: [{ label: 'Crecimiento ene-feb YoY', expression: "altas_ene_feb_2024 ? (altas_ene_feb_2025 / Math.max(altas_ene_feb_2024, 1)) - 1 : 0", format: 'percentage', decimals: 2 }] } },
      { id: 11, dashboard_id: 1, definition_id: 11, title: 'Crecimiento inscripciones YoY', subtitle: 'Ene-feb 2025 vs 2024', order: 11, size: { w: 3, h: 3 }, position: { x: 9, y: 6 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'emerald', showComponents: true, componentLabels: { altas_ene_feb_2025: 'Altas ene-feb 2025', altas_ene_feb_2024: 'Altas ene-feb 2024' } } },
      { id: 12, dashboard_id: 1, definition_id: 12, title: 'Bajas por mes', subtitle: 'Año en curso', order: 12, size: { w: 4, h: 3 }, position: { x: 0, y: 9 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'line', smooth: true } },
      { id: 13, dashboard_id: 1, definition_id: 13, title: 'Bajas mes vs anterior', subtitle: 'Mes en curso', order: 13, size: { w: 2, h: 3 }, position: { x: 4, y: 9 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'rose', showComponents: true, componentLabels: { bajas_mes_actual: 'Bajas mes actual', bajas_mes_anterior: 'Bajas mes anterior' } } },
      { id: 14, dashboard_id: 1, definition_id: 14, title: 'Bajas ene-feb YoY', subtitle: 'Comparativo anual', order: 14, size: { w: 2, h: 3 }, position: { x: 6, y: 9 }, time_window_override: '', custom_start_override: null, custom_end_override: null, options: { visualization: 'kpi', accent: 'rose', showComponents: true, componentLabels: { bajas_ene_feb_2025: 'Bajas ene-feb 2025', bajas_ene_feb_2024: 'Bajas ene-feb 2024' } } },
    ],
    widgetFilters: [],
    sourceSamples: {
      ventas: ventasRecords,
      egresos: egresosRecords,
      accesos: accesosRecords,
      altas: altasPlanRecords,
      flujo: financialFlowRecords,
    },
  }
}

export function cloneSeedData () {
  return JSON.parse(JSON.stringify(buildSeedData()))
}

export function buildSeedSamples () {
  return {
    ventasRecords,
    egresosRecords,
    accesosRecords,
    altasPlanRecords,
    financialFlowRecords,
  }
}

export const seedNow = seedTimestamp
